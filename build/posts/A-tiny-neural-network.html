<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A tiny neural network</title>
    <meta name="description" content="">
    <meta name="author" content="Hrishikesh Barman">

    <link href="/assets/main.css" rel="stylesheet">

  </head>

  <body class="">
<nav class="nav">
  <div class="nav-left"></div>
  <div class="nav-center">
  <a class="nav-item title is-5" href="/">
    geekodour's blog
  </a>
  </div>
  <span id="nav-toggle" class="nav-toggle">
  <span></span>
  <span></span>
  <span></span>
  </span>
  <div id="nav-menu" class="nav-right nav-menu">
  <a class="nav-item" href="">projects</a>
  <a class="nav-item" href="">favorites</a>
  <a class="nav-item" href="">contact</a>
  </div>
</nav>

      <div class="container">
  <div class="columns">
          <div class="column">
            <div class="section">
<div class="">
  <ul>
  </ul>
</div>
            </div>
          </div>
          <div class="column is-half">
<div class="section">
<div class="container">
<div class="content">
<h1>A tiny neural network</h1>
<p>The code in this post is functionally equivalent to <a href="https://iamtrask.github.io/2015/07/12/basic-python-network/">A Neural Network in 11 lines of Python</a>. The JavaScript translation was originally written by <a href="https://github.com/lucidrains">@lucidrains</a>.</p>
<p><a href="https://github.com/mateogianolio/vectorious">Vectorious</a> is an open-source linear algebra library which I am currently maintaining. We&#39;ll use it as a replacement for Python&#39;s <strong>numpy</strong>.</p>
<p>This is the source presented at the top of the Python article:</p>
<pre><code class="lang-python">X = np.array([[0, 0, 1], [0, 1, 1], [1, 0, 1], [1, 1, 1]])
y = np.array([[0, 1, 1, 0]]).T
syn0 = 2 * np.random.random((3, 4)) - 1
syn1 = 2 * np.random.random((4, 1)) - 1
for j in xrange(60000):
    l1 = 1 / (1 + np.exp(-(np.dot(X, syn0))))
    l2 = 1 / (1 + np.exp(-(np.dot(l1, syn1))))
    l2_delta = (y - l2) * (l2 * (1 - l2))
    l1_delta = l2_delta.dot(syn1.T) * (l1 * (1 - l1))
    syn1 += l1.T.dot(l2_delta)
    syn0 += X.T.dot(l1_delta)
</code></pre>
<p>Below is the JavaScript translation. To make it a bit more readable I extracted <a href="https://en.wikipedia.org/wiki/Sigmoid_function">the sigmoid function</a> and its derivative, which can be mapped to the elements of a matrix using <code>matrix.map(fn)</code>.</p>
<pre><code class="lang-javascript">function sigmoid(ddx) {
  return function (x) {
    return ddx ?
      x * (1 - x) :
      1.0 / (1 + Math.exp(-x));
  };
}

var X = new Matrix([[0, 0, 1], [0, 1, 1], [1, 0, 1], [1, 1, 1]]),
    y = new Matrix([[0, 1, 1, 0]]).T,
    syn0 = Matrix.random(3, 4, 2, -1),
    syn1 = Matrix.random(4, 1, 2, -1),
    l1, l2, l1_delta, l2_delta, i;
for (i = 0; i &lt; 60000; i++) {
  l1 = X.multiply(syn0).map(sigmoid());
  l2 = l1.multiply(syn1).map(sigmoid());
  l2_delta = Matrix.subtract(y, l2).product(l2.map(sigmoid(true)));
  l1_delta = l2_delta.multiply(syn1.T).product(l1.map(sigmoid(true)));
  syn1.add(l1.T.multiply(l2_delta));
  syn0.add(X.T.multiply(l1_delta));
}
</code></pre>
<p>Almost the same and above code can be used both in Node.js and the browser! The final prediction is in the <code>l2</code> variable and should be close to <code>y</code>.</p>
<p><a href="https://github.com/mateogianolio/vectorious/blob/master/examples/neural-network.js">Here is the full example with comments.</a></p>

</div>
</div>
</div>
          </div>
          <div class="column">
            <div class="section">
<div class="">
Hello, welcome to my blog
Here we have fun
</div>
            </div>
          </div>
  </div>
      </div>

      <script src="/assets/prism.js"></script>
      <script src="/assets/main.js"></script>
  </body>
</html>
